<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js"></script>
<script>

  log = function(v)
  {
    $('#log').append($('<p>'+v+'</p>'));
  }


  Turtle = new Object();

  Turtle.init = function(objid)
  {
    this.context = document.getElementById(objid).getContext("2d");

    this.width = this.context.canvas.width;
    this.height = this.context.canvas.height;
    this.pen = 1;
    this.restartpos();
  };

  Turtle.eraseall = function()
  {
    this.context.clearRect( 0, 0, this.width, this.height);
  };

  Turtle.restartpos = function()
  {
    this.x = this.width / 2;
    this.y = this.height / 2 ;
    this.angle = 0;
  };

  Turtle.walk = function(v)
  {
    var rad = this.angle / 180 * Math.PI
    xdir = Math.sin(rad) * parseFloat(v)
    ydir = Math.cos(rad) * parseFloat(v)

    this.moveTo(this.x + xdir, this.y + ydir);
  };

  Turtle.moveTo = function(x,y)
  {
    if(this.pen > 0)
    {
      this.context.beginPath()
      this.context.moveTo(this.x, this.y)
      this.context.lineTo(x, y)
      this.context.stroke()
    } 
    this.x = x; this.y = y
  };

  Turtle.logo = new Object();
  Turtle.logo.forward = function(v)
  { Turtle.walk(v);};

  Turtle.logo.backward = function(v)
  { Turtle.walk(-v); };

   Turtle.logo.right = function(v)
  { Turtle.angle += v; };

   Turtle.logo.left = function(v)
  { Turtle.angle -= v; };

  Turtle.logo.pendown = function()
  { Turtle.pen = 1; };

  Turtle.logo.penup = function()
  { Turtle.pen = 0; };

  Turtle.logo.home = function()
  { Turtle.restartpos()};

  Turtle.logo.clear = function()
  { Turtle.eraseall();};
</script>
<script type="text/javascript" src="parser.js"></script>
<script>

  $(function()
  {
    Turtle.init('place');
    
    $('#exec').click(function()
    {
      Turtle.run($('#thecode').val());
    });
  });

</script>

<canvas id="place" width="500" height="500" style="border: 1px solid;"></canvas>

<textarea id="thecode" style="width:200px; height:200px;">
</textarea><button id="exec" />

</form>
